<html>

<head>
  <meta charset="UTF-8">
  <title>Flatabout - Review From</title>
  <meta name="viewport" content="initial-scale=1" />
  <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/0.9.4/angular-material.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=RobotoDraft:300,400,500,700,400italic">
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular-animate.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular-aria.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/lodash.js/3.10.0/lodash.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angular_material/0.9.4/angular-material.min.js"></script>
</head>
<style>
md-toolbar {
  z-index: 1 !important;
}
</style>

<body ng-app="form" ng-controller="masterCtrl" ng-cloak style="overflow-y: hidden;">
  <div layout-sm="row" layout-align="center" layout-margin layout-fill layout-padding>
    <md-whiteframe class="md-whiteframe-z2" layout="column" layout-margin layout-fill layout-padding>
      <div flex>
        <md-content style="height: 100%">
          <section>
            <md-subheader class="md-primary" style="margin-left:1%;">Step One Of Five</md-subheader>
            <md-list>
            <!-- Option One -->
                <section class="md-whiteframe-z1" layout layout-align="center center" layout-margin layout-padding class="md-3-line">
                  <md-content flex>
                    <md-toolbar>
                      <div class="md-toolbar-tools">
                      <h2>{{reviewData.caption}} <span class="radioValue">{{ data.residency_type }}</span></h2>
                      </div>
                    </md-toolbar>
                    <md-radio-group ng-model="data.residency_type">
                      <md-radio-button value="{{choice.value}}" ng-repeat="choice in reviewData.residency_type">{{choice.value}}</md-radio-button>
                    </md-radio-group>
                </md-content>
                </section>

            <!-- Option Two -->
                <section class="md-whiteframe-z1" layout layout-align="center center" layout-margin layout-padding class="md-3-line">
                  <md-content flex>
                    <md-toolbar>
                      <div class="md-toolbar-tools">
                      <h2>{{tor.title}} <span class="radioValue">{{ data.tags }}</span></h2>
                      </div>
                    </md-toolbar>
                    <md-radio-group ng-model="data.tags">
                      <md-radio-button value="{{choice.id}}" ng-repeat="choice in tor.tags">{{choice.title}}</md-radio-button>
                    </md-radio-group>
                </md-content>
                </section>

                <!-- Option 3 -->
                <section class="md-whiteframe-z1" layout layout-align="center center" layout-margin layout-padding class="md-3-line">
                  <md-content flex>
                    <md-toolbar>
                      <div class="md-toolbar-tools">
                      <h2>Duration of Stay<span class="radioValue">{{ data.duration }}</span></h2>
                      </div>
                    </md-toolbar>
                       <md-slider flex min="0" max="255" ng-model="data.duration" aria-label="red" id="red-slider" class>
                       </md-slider>
                </md-content>
                </section>

                <!-- Option 4 -->
                <section class="md-whiteframe-z1" layout layout-align="center center" layout-margin layout-padding class="md-3-line">
                  <md-content flex>
                    <md-toolbar>
                      <div class="md-toolbar-tools">
                      <h2>Rent</h2>
                      </div>
                    </md-toolbar>
                      <md-input-container layout-margin layout-padding>
                        <!-- Use floating label instead of placeholder -->
                        <label>Rent</label>
                        <input ng-model="data.rent" type="text">
                      </md-input-container>
                  </md-content>
                </section>
            </md-list>
          </section>
          <section>
            <md-subheader class="md-warn" style="margin-left:1%;">Step Two Of Five</md-subheader>
            <md-list layout="column" layout-padding>
                <section class="md-whiteframe-z1" layout layout-align="center center" layout-margin layout-padding class="md-3-line" ng-repeat="message in tags">
                  <md-content flex>
                    <md-toolbar>
                      <div class="md-toolbar-tools">
                      <h2>{{message.title}}</h2>
                      </div>
                    </md-toolbar>
                      <md-input-container layout-margin layout-padding>
                      <md-radio-group ng-model="data.tags" ng-if="message.type === 'radio'">
                        <md-radio-button value="{{choice.id}}" ng-repeat="choice in message.tags">{{choice.title}}</md-radio-button>
                      </md-radio-group>
                       <md-checkbox ng-model="data.cb1" ng-if="message.type === 'checkbox'" aria-label="Checkbox 1" ng-repeat="choice in message.tags">
                                  {{choice.title}}
                      </md-checkbox>
                      <div ng-if="message.type === 'boolean'">
                        <md-radio-group ng-models="data.selected" ng-hide="loadQuestions">
                        <md-radio-button value="true" aria-label="Checkbox 1" ng-click="loadQuestions = true">
                                  Yes
                        </md-radio-button>
                        <md-radio-button value="false" aria-label="Checkbox 2">
                                    No
                        </md-radio-button>
                        </md-radio-group>
                        <md-checkbox ng-model="data.cb1" ng-show="loadQuestions" aria-label="Checkbox 1" ng-repeat="choice in message.tags">
                                  {{choice.title}}
                      </md-checkbox>

                      </div>
                      <div ng-if="message.type === 'text'">
                        <label>{{message.title}}</label>
                        <input ng-model="data.rent" type="text">
                      </div>
                      </md-input-container>
                  </md-content>
                </section>
            </md-list>
          </section>
          <section>
            <md-subheader class="md-accent" style="margin-left:1%;">Step Three Of Five</md-subheader>
            <md-list layout="column" layout-padding>
                <section class="md-whiteframe-z1" layout layout-align="center center" layout-margin layout-padding class="md-3-line" ng-repeat="message in messages">
                    <h1>{{message.what}}</h1>
                </section>
            </md-list>
          </section>
        </md-content>
      </div>
    </md-whiteframe>
  </div>
  <script>
    window.reviewables = <%- JSON.stringify(reviewables) %>;
    window.reviews = <%- JSON.stringify(reviewViews) %>;


    var app = angular.module('form', ['ngMaterial']);
    app.config(function($mdThemingProvider) {
        $mdThemingProvider.theme('default')
          .primaryPalette('indigo')
          .accentPalette('orange');
    });
    app.factory('revieWables', function ($window) {
      var tags = function () {
        return $window.reviewables;
      };

      return {
        tags: tags
      };
    });
    app.controller('masterCtrl', [
      '$scope', 'revieWables',
      function($scope, revieWables) {
        $scope.test = 'Foo Bar';
        $scope.reviewData = {
          caption: "You are reviewing...",
          residency_type: [{
            key: "c_r",
            value: "Current residence"
          },{
            key: "p_r",
            value: "Previous residence"
          },{
            key: "s_e_r",
            value: "Someones else's residence"
          }]
        };
        var reviewables = revieWables.tags();
        reviewables = _.sortBy(reviewables, 'id');
        $scope.tor = reviewables[0];
        var imagePath = null;

        var sortedData = _.slice(reviewables, 1, reviewables.length);
        var stepOne = ["ownership", "rent", "type-of-residents", "duration"];
        var orderedData = _.sortByOrder(reviewables, 'slug');
        var stepTwo = [];
        _.forEach(reviews, function(elm) {
          console.log(elm);
          if(_.findWhere(sortedData, {'slug': elm.view})){
            stepTwo.push(_.extend({}, _.findWhere(sortedData, {'slug': elm.view}), {type: elm.type}));
          }
        });
        $scope.tags = stepTwo;
        console.log(stepTwo);
      }
    ]);
  </script>
</body>

</html>